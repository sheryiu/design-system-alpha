import{a as S}from"./chunk-CDNMNCED.js";import{a as pe}from"./chunk-KPDSPZS3.js";import{Aa as a,B as b,Ba as p,Bc as ee,Cc as te,D as I,Ea as j,Fa as g,Ga as u,Jc as ie,L as _,La as l,N as x,Na as K,Pa as v,Rb as Q,S as M,T as U,Ta as C,Ua as L,Va as Z,Vc as ne,a as O,c as w,ca as f,e as z,eb as q,fb as G,fc as W,ga as V,h,ia as N,jd as ae,k as D,kc as X,kd as oe,la as J,lc as Y,m as k,na as d,p as E,pd as re,qa as F,qd as se,rd as le,s as $,t as P,ua as c,ud as de,v as T,x as B,z as R,za as o}from"./chunk-3M4ZY3CN.js";import"./chunk-6RDLFHTQ.js";import{a as y}from"./chunk-CWTPBX7D.js";function ue(t,i){if(t&1&&p(0,"phead-linear-progress-display",9),t&2){let r=u();F("value",r.completedRows*100/r.totalRows)}}function he(t,i){t&1&&d(0,ue,1,1,"phead-linear-progress-display",8),t&2&&c(0,i.totalRows>0?0:-1)}function be(t,i){if(t&1){let r=j();o(0,"button",10),g("click",function(){M(r);let e=u();return U(e.onDownloadClick())}),l(1,"Download"),a()}}function _e(t,i){if(t&1&&p(0,"phead-linear-progress-display",9),t&2){let r=u();F("value",r.completedRows*100/r.totalRows)}}function xe(t,i){t&1&&d(0,_e,1,1,"phead-linear-progress-display",8),t&2&&c(0,i.totalRows>0?0:-1)}function ge(t,i){if(t&1){let r=j();o(0,"button",10),g("click",function(){M(r);let e=u();return U(e.onUploadClick())}),l(1,"Upload"),a()}}function ve(t,i){if(t&1&&(o(0,"span",6),l(1),C(2,"number"),o(3,"span",11),l(4,"KB"),a()()),t&2){let r;f(),K("",Z(2,1,((r=i.used)!==null&&r!==void 0?r:0)/1024,"1.2-2")," ")}}var me=(()=>{let i=class i extends W{constructor(){super(),this.service=_(pe),this.zone=_(N),this.renderer=_(V),this._downloadProgress$=new w(void 0),this.downloadProgress$=this._downloadProgress$.pipe(B(),$(([s,e])=>k(s==null||e?.completedRows==0?0:300).pipe(h(()=>e))),R(1)),this._uploadProgress$=new w(void 0),this.uploadProgress$=this._uploadProgress$.pipe(B(),$(([s,e])=>k(s==null||e?.completedRows==0?0:300).pipe(h(()=>e))),R(1)),this.onDownloadClick=this.createEffectFn(s=>s.pipe(T(()=>z(this.service.export({progressCallback:e=>(this.zone.run(()=>{this._downloadProgress$.next(y({},e)),e.done&&this._downloadProgress$.next(void 0)}),!0)})).pipe(b(e=>D(()=>this.downloadProgress$.pipe(E(n=>n==null),P(1),h(()=>e)))),I(e=>{let n=this.renderer.createElement("a");n.download="download.json",n.href=URL.createObjectURL(new Blob([e])),n.click(),URL.revokeObjectURL(n.href)}))))),this.onUploadClick=this.createEffectFn(s=>s.pipe(T(()=>new O(e=>{let n=this.renderer.createElement("input");n.type="file",n.accept="application/json",n.addEventListener("change",()=>{let m=new FileReader;m.addEventListener("load",()=>{e.next(m.result),e.complete()}),m.readAsArrayBuffer(n.files[0])}),n.click()}).pipe(b(e=>this.service.import(new Blob([e]),{clearTablesBeforeImport:!0,progressCallback:n=>(this.zone.run(()=>{this._uploadProgress$.next(y({},n)),n.done&&this._uploadProgress$.next(void 0)}),!0)})),b(()=>D(()=>this.uploadProgress$.pipe(E(e=>e==null),P(1)))))))),!(this.service.isServer||!this.service.bytesUsed$)&&(this.bytesUsed$$=Q(this.service.bytesUsed$))}onDeleteAllClick(){this.service.emptyDatabase()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=x({type:i,selectors:[["demo-settings-database"]],standalone:!0,features:[J,v],decls:29,vars:7,consts:[[1,"flex","flex-col","px-4"],[1,"flex","py-3","gap-6","justify-between","items-center"],[1,"flex","flex-col","gap-px"],[1,"font-bold","tracking-tight","text-primary-800","dark:text-primary-200"],[1,"font-light","text-secondary"],[1,"flex","gap-4","items-center"],[1,"font-bold"],["pheadHoverable","","pheadHardSurface","","color","red",1,"rounded-1","px-3","py-2",3,"click"],[1,"h-6","max-w-120","my-0.5"],[1,"h-6","max-w-120","my-0.5",3,"value"],["pheadHoverable","","pheadHardSurface","","color","primary",1,"rounded-1","px-3","py-2",3,"click"],[1,"text-secondary","text-sm","font-normal"]],template:function(e,n){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),l(4,"Export Database"),a(),o(5,"span",4),l(6,"Download the database as one JSON file"),a()(),d(7,he,1,1),C(8,"async"),d(9,be,2,0),a(),p(10,"phead-divider"),o(11,"div",1)(12,"div",2)(13,"span",3),l(14,"Import Database"),a(),o(15,"span",4),l(16,"Upload a JSON file"),a()(),d(17,xe,1,1),C(18,"async"),d(19,ge,2,0),a(),p(20,"phead-divider"),o(21,"div",1)(22,"div",2)(23,"span",3),l(24,"Database Size"),a()(),o(25,"div",5),d(26,ve,5,4,"span",6),o(27,"button",7),g("click",function(){return n.onDeleteAllClick()}),l(28,"Delete All"),a()()()()),e&2){let m,A,H;f(7),c(7,(m=L(8,3,n.downloadProgress$))?7:9,m),f(10),c(17,(A=L(18,5,n.uploadProgress$))?17:19,A),f(9),c(26,(H=n.bytesUsed$$==null?null:n.bytesUsed$$())?26:-1,H)}},dependencies:[S,Y,X,q,G,ie,te]});let t=i;return t})();function Ce(t,i){t&1&&(o(0,"div",3)(1,"div",4)(2,"span"),l(3,"Database"),a()(),p(4,"demo-settings-database"),a())}var je=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=x({type:i,selectors:[["app-settings"]],standalone:!0,features:[v],decls:6,vars:0,consts:[["pheadSidebarContainer",""],["pheadSidebarBreadcrumbs",""],["pheadTabBarContainer","","class","flex flex-col gap-4 pe-6 py-6",4,"pheadSidebarMain"],["pheadTabBarContainer","",1,"flex","flex-col","gap-4","pe-6","py-6"],[1,"bg-hover","text-primary-700","dark:text-primary-500","text-base","font-medium","me-4","border","border-s-0","rounded-e-1","py-1","ps-4","pe-2","min-h-11","flex","justify-between","items-center","gap-2"]],template:function(e,n){e&1&&(o(0,"phead-layered-container")(1,"div",0)(2,"div",1),p(3,"phead-breadcrumbs"),a(),o(4,"phead-sidebar-content"),d(5,Ce,5,0,"div",2),a()()())},dependencies:[S,ee,me,ne,le,oe,ae,se,re,de]});let t=i;return t})();export{je as SettingsComponent};
