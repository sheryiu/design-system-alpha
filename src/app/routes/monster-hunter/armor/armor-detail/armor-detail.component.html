<core-sectioned-outlet>
  <div
    class="h-full relative flex flex-col overflow-x-hidden overflow-y-auto gutter-stable"
    cdkVirtualScrollingElement
    cdkScrollable
    coreTabBarContainerElement
  >
    <div class="bg-deep-glass grow p-2">
      <div class="flex flex-col">
        <core-simple-header
          coreStickyHeader
          checkFor="-168"
          class="h-64 -top-[11.5rem]">
          <div *coreHeader>
            @if (headerImage$ | async; as bgImage) {
              <div
                class="absolute inset-0 -z-10 bg-cover bg-center group-data-[stuck=true]/header:blur from-60% from-lunar-green-100/50 to-lunar-green-100 dark:from-lunar-green-950/50 dark:to-lunar-green-950 transition-all"
                [style.backgroundImage]="bgImage"
              ></div>
            }
            @if (data$ | async; as data) {
              <h2><core-multilingual-text-display [value]="data.name"></core-multilingual-text-display></h2>
            }
          </div>
        </core-simple-header>
        <div class="flex flex-col gap-4 pt-4">
          <core-tab-bar coreStickyHeader checkFor="88" class="top-18 data-[stuck=true]:bg-lunar-green-100 data-[stuck=true]:dark:bg-lunar-green-950"></core-tab-bar>
          <div class="px-2 flex gap-2 items-center">
            @if (data$ | async; as data) {
              <span class="font-medium whitespace-nowrap shrink-0">Rare {{ data.rarity }}</span>
            }
            <div class="flex gap-0.5 shrink-0">
              @if (data$ | async; as data) {
                <core-rating-display [value]="data.rarity"></core-rating-display>
              }
            </div>
          </div>
          <core-tab-bar-header class="-ms-2" label="Stats">
            Stats
            <div *coreTabBarHeaderSupplementary class="flex items-center">
              <a coreHoverable class="rounded-2 size-8" [routerLink]="['edit-stats']">
                <i class="icon-5 font-variation-fill">edit</i>
              </a>
            </div>
          </core-tab-bar-header>
          <div class="px-2 flex items-center gap-2">
            <i class="icon-6 font-variation-fill text-primary-500 shrink-0">shield</i>
            <div class="flex flex-col">
              <span class="font-medium">
                @if (data$ | async; as data) {
                  {{ data.maxDef }} at Lv.{{ data.maxLevel }}
                }
              </span>
              <span class="text-sm text-secondary">
                @if (data$ | async; as data) {
                  {{ data.baseDef }} at Lv.1
                }
              </span>
            </div>
          </div>
          <div class="px-2 flex items-center gap-2">
            <i class="icon-6 font-variation-fill text-primary-500 shrink-0">masked_transitions</i>
            <div class="flex flex-col">
              <span class="font-medium">
                @if (data$ | async; as data) {
                  {{ data.decorationSlots }}
                }
              </span>
            </div>
          </div>
          <core-tab-bar-header class="-ms-2" label="Skills">
            Skills
            <div *coreTabBarHeaderSupplementary class="flex items-center">
              <a coreHoverable class="rounded-2 size-8" [routerLink]="['edit-skills']">
                <i class="icon-5 font-variation-fill">edit</i>
              </a>
            </div>
          </core-tab-bar-header>
          <div class="px-2 flex gap-2">
            @if (data$ | async; as data) {
              @for (armorSkill of data.skills; track armorSkill.skillId) {
                <div class="flex items-center gap-2 w-full">
                  @if (armorSkill.skillId | skillData | async; as skill) {
                    <div class="hexagon-mask size-6 shrink-0" [style.background-color]="skill.color"></div>
                    <div class="flex flex-col gap-0.5 grow">
                      <core-multilingual-text-display [value]="skill.name"></core-multilingual-text-display>
                      <p class="text-sm text-secondary"><core-multilingual-text-display [value]="skill.description"></core-multilingual-text-display></p>
                    </div>
                    <div class="shrink-0 text-secondary uppercase font-bold">
                      <span>Lv {{ armorSkill.levels }}</span>
                    </div>
                  }
                </div>
              } @empty {
                <span class="text-secondary text-sm uppercase">No Skills</span>
              }
            }
          </div>
          <core-tab-bar-header class="-ms-2" label="Crafting">
            Crafting
          </core-tab-bar-header>
          <div></div>
        </div>
      </div>
    </div>
    @if (data$ | async; as data) {
      <core-supplementary-panel
        class="mt-4"
        [createdAt]="data.createdAt"
        [updatedAt]="data.updatedAt"
      >
      </core-supplementary-panel>
    }
  </div>
</core-sectioned-outlet>